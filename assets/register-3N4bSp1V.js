import{r as s,j as e,J as Y,A,K,M as C,Q as T,U as W,V as J,x as V,W as X,X as I,Y as M,Z as G,_ as H,B as Q,L as Z,t as z,$ as P}from"./index-CLobNv0F.js";import{T as ee,I as S}from"./theme-switch-D0fkhlzt.js";import{u as q,f as se,M as te,a as ae,P as re,L as ne,m as B,b as L}from"./password-input-uantj9K5.js";function D(){const a=s.useRef(!1);return q(()=>(a.current=!0,()=>{a.current=!1}),[]),a}function oe(){const a=D(),[l,t]=s.useState(0),o=s.useCallback(()=>{a.current&&t(l+1)},[l]);return[s.useCallback(()=>se.postRender(o),[o]),l]}class ie extends s.Component{getSnapshotBeforeUpdate(l){const t=this.props.childRef.current;if(t&&l.isPresent&&!this.props.isPresent){const o=this.props.sizeRef.current;o.height=t.offsetHeight||0,o.width=t.offsetWidth||0,o.top=t.offsetTop,o.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function le({children:a,isPresent:l}){const t=s.useId(),o=s.useRef(null),w=s.useRef({width:0,height:0,top:0,left:0}),{nonce:b}=s.useContext(te);return s.useInsertionEffect(()=>{const{width:g,height:h,top:v,left:j}=w.current;if(l||!o.current||!g||!h)return;o.current.dataset.motionPopId=t;const r=document.createElement("style");return b&&(r.nonce=b),document.head.appendChild(r),r.sheet&&r.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${g}px !important;
            height: ${h}px !important;
            top: ${v}px !important;
            left: ${j}px !important;
          }
        `),()=>{document.head.removeChild(r)}},[l]),e.jsx(ie,{isPresent:l,childRef:o,sizeRef:w,children:s.cloneElement(a,{ref:o})})}const O=({children:a,initial:l,isPresent:t,onExitComplete:o,custom:w,presenceAffectsLayout:b,mode:g})=>{const h=ae(ce),v=s.useId(),j=s.useMemo(()=>({id:v,initial:l,isPresent:t,custom:w,onExitComplete:r=>{h.set(r,!0);for(const i of h.values())if(!i)return;o&&o()},register:r=>(h.set(r,!1),()=>h.delete(r))}),b?[Math.random()]:[t]);return s.useMemo(()=>{h.forEach((r,i)=>h.set(i,!1))},[t]),s.useEffect(()=>{!t&&!h.size&&o&&o()},[t]),g==="popLayout"&&(a=e.jsx(le,{isPresent:t,children:a})),e.jsx(re.Provider,{value:j,children:a})};function ce(){return new Map}function de(a){return s.useEffect(()=>()=>a(),[])}const y=a=>a.key||"";function me(a,l){a.forEach(t=>{const o=y(t);l.set(o,t)})}function ue(a){const l=[];return s.Children.forEach(a,t=>{s.isValidElement(t)&&l.push(t)}),l}const he=({children:a,custom:l,initial:t=!0,onExitComplete:o,exitBeforeEnter:w,presenceAffectsLayout:b=!0,mode:g="sync"})=>{const h=s.useContext(ne).forceRender||oe()[0],v=D(),j=ue(a);let r=j;const i=s.useRef(new Map).current,N=s.useRef(r),f=s.useRef(new Map).current,c=s.useRef(!0);if(q(()=>{c.current=!1,me(j,f),N.current=r}),de(()=>{c.current=!0,f.clear(),i.clear()}),c.current)return e.jsx(e.Fragment,{children:r.map(d=>e.jsx(O,{isPresent:!0,initial:t?void 0:!1,presenceAffectsLayout:b,mode:g,children:d},y(d)))});r=[...r];const x=N.current.map(y),F=j.map(y),_=x.length;for(let d=0;d<_;d++){const p=x[d];F.indexOf(p)===-1&&!i.has(p)&&i.set(p,void 0)}return g==="wait"&&i.size&&(r=[]),i.forEach((d,p)=>{if(F.indexOf(p)!==-1)return;const m=f.get(p);if(!m)return;const n=x.indexOf(p);let u=d;if(!u){const R=()=>{i.delete(p);const k=Array.from(f.keys()).filter(E=>!F.includes(E));if(k.forEach(E=>f.delete(E)),N.current=j.filter(E=>{const $=y(E);return $===p||k.includes($)}),!i.size){if(v.current===!1)return;h(),o&&o()}};u=e.jsx(O,{isPresent:!1,onExitComplete:R,custom:l,presenceAffectsLayout:b,mode:g,children:m},y(m)),i.set(p,u)}r.splice(n,0,u)}),r=r.map(d=>{const p=d.key;return i.has(p)?d:e.jsx(O,{isPresent:!0,presenceAffectsLayout:b,mode:g,children:d},y(d))}),e.jsx(e.Fragment,{children:i.size?r:r.map(d=>s.cloneElement(d))})},pe="http://127.0.0.1:8000/api/register/",fe="http://127.0.0.1:8000/api/google/",xe="605198548741-b2q4afevqivu38bh875sj285fepq94g5.apps.googleusercontent.com",ge={initial:{height:0,opacity:0},animate:{height:170,opacity:1,transition:{type:"spring",duration:.8,stiffness:250,delayChildren:.3,staggerChildren:.2}},exit:{height:0,opacity:0}},U={initial:{opacity:0,left:"-100px"},animate:{opacity:1,left:0}},Ne=()=>{const a=Y(),{user:l,setUser:t,setToken:o}=s.useContext(A),[w,b]=s.useState(!1),[g,h]=s.useState(!1),v=K({username:C().min(5,"Must be 5 characters or more").required("Enter Your Username"),firstname:C(),lastname:C(),email:C().email("Invalid email address").required("Enter Your Email Address"),password:C().min(6,"Password must be at least 6 characters").required("please provide a password"),confirmpassword:C().oneOf([T("password"),null],"Passwords must match").required("please provide a password")}),j=W({mutationFn:async m=>{try{const n=await z.post(pe,m);console.log(n),n.status===201&&(P.success("Welcome fellow hacker"),a("/login"))}catch(n){console.log(n),P.error(n==null?void 0:n.message)}}}),{handleSubmit:r,handleChange:i,handleBlur:N,values:f,touched:c,errors:x,resetForm:F,validateForm:_}=J({initialValues:{email:"",username:"",firstname:"",lastname:"",password:"",confirmpassword:""},validationSchema:v,onSubmit:async m=>{const n=new FormData;n.append("email",m.email),n.append("username",m.username),n.append("firstname",m.firstname),n.append("lastname",m.lastname),n.append("password",m.password),j.mutate(n)},validateOnBlur:!0,validateOnChange:!0}),d=async m=>{m.preventDefault();const n=await _();Object.keys(n).length>0?Object.keys(n).forEach(u=>{n[u]&&P.error(n[u])}):r()},p=async m=>{h(!0);try{const n=m.credential,u=await z.post(fe,{access_token:n});console.log(u);const R={user_id:u.data.id,wallet:u.data.wallet,email:u.data.email,username:u.data.full_name},k={access:u.data.access,refresh:u.data.refresh};console.log(u),u.status===200&&(t(R),o(k),localStorage.setItem("tokens",JSON.stringify(k)),localStorage.setItem("user",JSON.stringify(R)),a("/"),P.success("Welcome to X-Shark"))}catch(n){console.log(n),h(!1)}};return s.useEffect(()=>{google==null||google.accounts.id.initialize({client_id:xe,callback:p}),google==null||google.accounts.id.renderButton(document.getElementById("signinDiv"),{theme:"outline",size:"large",text:"continue_with",shape:"circle"})},[]),l?e.jsx(V,{to:"/"}):e.jsxs(e.Fragment,{children:[(j.isPending||g)&&e.jsx("div",{className:"z-[999999999999999] fixed inset-0 bg-black bg-opacity-60",children:e.jsx(X,{})}),e.jsxs(B.section,{className:"register overflow-hidden min-h-screen flex items-end md:items-center justify-center",children:[e.jsx("div",{className:"hidden md:block logo-animation",children:e.jsx("img",{src:"/logo2.png",width:"100%",height:"100px",className:"border-3"})}),e.jsxs("div",{className:"w-full sm:max-w-[400px] md:p-6 p-3 bg-transparent",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"hidden lg:block text-2xl font-bold tracking-tight text-white",children:e.jsx("h1",{className:"md:text-4xl",children:"X-Shark"})}),e.jsx("div",{className:"block lg:hidden md:block logo-animation",children:e.jsx("img",{src:"/logo2.png",width:"50%",height:"100px"})}),e.jsx(ee,{})]}),e.jsx("p",{className:"text-sm font-normal text-white my-1 jost",children:"Please fill in your details to get started"}),e.jsxs("form",{onSubmit:d,children:[e.jsx("div",{className:"",children:e.jsxs("label",{className:"font-light",htmlFor:"username",children:[e.jsx("p",{className:"text-white text-sm",children:"Username"}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{name:"username",type:"text",id:"username",onChange:i,onBlur:N,value:f.username,className:`${c.username&&x.username?"border-red-500":c.username&&"border-green-500"} border-black`,placeholder:"Enter Your Username"}),c.username&&x.username?e.jsx(I,{color:"red",className:"absolute right-4 top-1/2 -translate-y-1/2"}):c.username&&e.jsx(M,{color:"green",className:"absolute right-4 top-1/2 -translate-y-1/2"})]})]})}),e.jsx("div",{className:"my-2",children:e.jsxs("label",{className:"font-light",htmlFor:"email",children:[e.jsx("p",{className:"text-white text-sm",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{type:"text",name:"email",id:"email",onChange:i,onBlur:N,value:f.email,className:` ${c.email&&x.email?"border-red-500":c.email&&"border-green-500"} border-black`,placeholder:"Enter Your Email"}),c.email&&x.email?e.jsx(I,{color:"red",className:"absolute right-4 top-1/2 -translate-y-1/2"}):c.email&&e.jsx(M,{color:"green",className:"absolute right-4 top-1/2 -translate-y-1/2"})]})]})}),e.jsx("div",{className:"my-2",children:e.jsxs("label",{className:"font-light",htmlFor:"password",children:[e.jsx("p",{className:"text-white text-sm",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(L,{name:"password",id:"password",onChange:i,onBlur:N,value:f.password,className:` ${c.password&&x.password?"border-red-500":c.password&&"border-green-500"} border-black`,placeholder:"Enter Your Password"}),c.password&&x.password?e.jsx(I,{color:"red",className:"absolute right-4 top-1/2 -translate-y-1/2"}):c.password&&e.jsx(M,{color:"green",className:"absolute right-4 top-1/2 -translate-y-1/2"})]})]})}),e.jsx("div",{className:"my-2",children:e.jsxs("label",{className:"font-light",htmlFor:"confirmpassword",children:[e.jsx("p",{className:"text-white text-sm",children:"Confirm-password"}),e.jsxs("div",{className:"relative",children:[e.jsx(L,{name:"confirmpassword",id:"confirmpassword",onChange:i,onBlur:N,value:f.confirmpassword,className:` ${c.confirmpassword&&x.confirmpassword?"border-red-500":c.confirmpassword&&"border-green-500"} border-black `,placeholder:"Confirm Your Password"}),c.confirmpassword&&x.confirmpassword?e.jsx(I,{color:"red",className:"absolute right-4 top-1/2 -translate-y-1/2"}):c.confirmpassword&&e.jsx(M,{color:"green",className:"absolute right-4 top-1/2 -translate-y-1/2"})]})]})}),e.jsxs("p",{onClickCapture:()=>b(m=>!m),className:"my-2 text-white cursor-pointer flex items-center gap-2 font-semibold text-sm",children:["Optional Information ",w?e.jsx(G,{}):e.jsx(H,{size:10})]}),e.jsx(he,{children:w&&e.jsxs(B.div,{variants:ge,animate:w?"animate":"initial",exit:"exit",className:"origin-top overflow-hidden",children:[e.jsx(B.div,{variants:U,className:"",children:e.jsxs("label",{className:"font-light",htmlFor:"first_name",children:[e.jsx("p",{className:"text-white",children:"First Name"}),e.jsx(S,{name:"firstname",type:"text",id:"firstname",value:f.firstname,onChange:i,onBlur:N})]})}),e.jsx(B.div,{variants:U,className:"my-2",children:e.jsxs("label",{className:"font-light",htmlFor:"last-name",children:[e.jsx("p",{className:"text-white",children:"Last Name"}),e.jsx(S,{name:"lastname",type:"text",id:"lastname",onChange:i,onBlur:N,value:f.lastname})]})})]})}),e.jsx(Q,{type:"submit",className:"w-full mb-2",children:"Create Account"}),e.jsx("p",{className:"text-center font-extralight py-1",children:"or"})]}),e.jsx("div",{id:"signinDiv",className:"login-options flex flex-col gap-3 font-medium"}),e.jsxs("p",{className:"text-xs mt-4 font-medium text-white jost",children:["Already have an account?"," ",e.jsx(Z,{className:"underline underline-offset-2 text-blue-400",to:"/login",children:"Log In"})]})]})]})]})};export{Ne as default};
